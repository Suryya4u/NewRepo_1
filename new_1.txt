this is modified from b1